<!DOCTYPE html>
<html>
	<head>
	</head>
	<body>
	<div id="fb-root"></div>
		<div class="main">
		
		<h1>Logged in!</h1>
		<div>
		 Hello <a id="yourName"></a>
		</div>
		
		<canvas data-processing-sources="/resources/pde/wander_main/wander_main.pde 
		/resources/pde/wander_main/InputText.pde
		/resources/pde/wander_main/InputButton.pde
		/resources/pde/wander_main/Input.pde"></canvas>
		<script>
			var appId = '568077023249265';

			window.fbAsyncInit = function() {
				// init the FB JS SDK
				FB.init({
					appId      : appId,                    // App ID from the app dashboard
					status     : true,                                 // Check Facebook Login status
					xfbml      : true                                  // Look for social plugins on the page
				});
				
				var uri = encodeURI('http://localhost:8000/wander');
				FB.getLoginStatus(function(response) {
					if (response.status === 'connected') {
						var accessToken = response.authResponse.accessToken;
						$.cookie("fbwat", accessToken);
						
						if(window.location.pathname != "/wander/") {
							window.location.href = uri;
						}
						
						FB.api('/me', function(response) {
							$("#yourName").append(response.name);
							var jsString = response.name;
							
						});
						
					} else {
						window.location = encodeURI("https://www.facebook.com/dialog/oauth?client_id=" + appId + "&redirect_uri="+uri+"&response_type=token");
					}
				});
			};
			// Load the SDK asynchronously
			(function(d, s, id){
				 var js, fjs = d.getElementsByTagName(s)[0];
				 if (d.getElementById(id)) {return;}
				 js = d.createElement(s); js.id = id;
				 js.src = "//connect.facebook.net/en_US/all.js";
				 fjs.parentNode.insertBefore(js, fjs);
			}(document, 'script', 'facebook-jssdk'));
		</script>
		
		</div>
		
		<script type="text/javascript" src="/resources/js/jquery-1.10.2.min.js"></script>
		<script type="text/javascript" src="/resources/js/jquery.cookie.js"></script>
		<script type="text/javascript" src="/resources/js/processing-1.4.1.min.js"></script>
		<script type="text/javascript" src="/resources/js/facebook.js"></script>
	</body>
</html>